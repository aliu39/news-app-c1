(this["webpackJsonpnews-app"]=this["webpackJsonpnews-app"]||[]).push([[0],{13:function(t,e,a){},14:function(t,e,a){"use strict";a.r(e);var s=a(0),c=a(1),n=a.n(c),r=a(7),o=a.n(r),i=(a(13),a(2)),l=a(3),u=a(5),h=a(4),d=function(t){Object(u.a)(a,t);var e=Object(h.a)(a);function a(t){var s;return Object(i.a)(this,a),(s=e.call(this,t)).saveArticle=function(){s.setState({cached:!0})},s.state={img_src:t.info.urlToImage,source:t.info.source.name,title:t.info.title,description:t.info.description,url:t.info.url,content:t.info.content,fullData:t.info,strData:JSON.stringify(t.info),cached:!1,tab:t.tab},s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){console.log("new article")}},{key:"componentWillUnmount",value:function(){console.log("destroying article")}},{key:"render",value:function(){return Object(s.jsxs)("div",{className:"article",children:[Object(s.jsx)("img",{src:null!=this.state.img_src?this.state.img_src:"https://www.sahilgraphics.com/wp-content/themes/shahil/assets/images/image-not-found.jpg"}),Object(s.jsxs)("p",{children:[Object(s.jsx)("b",{children:this.state.title+" "+this.state.source})," ",Object(s.jsx)("br",{}),this.state.description," ",Object(s.jsx)("br",{})]}),Object(s.jsx)("p",{children:this.state.content}),Object(s.jsxs)("p",{align:"right",children:[Object(s.jsx)("a",{href:this.state.url,target:"_blank",rel:"noreferrer",children:"original article"})," ",Object(s.jsx)("br",{}),this.state.tab?null:Object(s.jsx)("button",{className:"tab",onClick:this.saveArticle,children:"save"})]})]})}}]),a}(n.a.Component),b=function(t){Object(u.a)(a,t);var e=Object(h.a)(a);function a(t){var s;return Object(i.a)(this,a),(s=e.call(this,t)).composeUrl=function(){var t="https://cors-anywhere.herokuapp.com/https://newsapi.org/v2/top-headlines?apiKey=78b9d599c4f94f8fa3afb1a5458928d6"+(s.state.US?"&country=us":"")+"&pageSize=20&page="+s.state.currPage+"&category="+s.state.category;if(s.state.keywords.length>0){t+="&q=";for(var e=0;e<s.state.keywords.length;e++)t+=s.state.keywords[e]}return t},s.getNews=function(){if(""!==s.state.category){var t=new Headers;t.append("Accept","application/json");var e=s.composeUrl();console.log(e);var a=new Request(e,{method:"GET",headers:t,mode:"cors"});fetch(a).then((function(t){if(t.ok)return t.json();throw new Error("faulty response status "+t.status)})).then((function(t){s.state.tab?s.toggleTab():s.updateCache(),console.log(t.totalResults);for(var e=[],a=[],c=0;c<t.articles.length;c++)e.push(t.articles[c]),a.push(n.a.createRef());s.setState({articles:e,refs:a})})).catch((function(t){console.log("ERROR: ",t.message)}))}},s.updateRefs=function(){},s.updateCache=function(){console.log("cache update");for(var t=[],e=new Set,a=0,c=0;a<20&&c<s.state.refs.length;c++){var n=s.state.refs[c].current;n.state.cached&&(t.push(n.state.fullData),e.add(n.state.url),a++)}for(var r=0;a<20&&r<s.state.cache.length;r++){var o=s.state.cache[r];e.has(o.url)?console.log("deleted old save entry"):(t.push(o),a++)}return t},s.clearCache=function(){s.state.tab&&s.setState({articles:[]})},s.toggleTab=function(){var t=s.state.tab?s.state.cache:s.updateCache();s.setState({articles:t,tab:!s.state.tab,cache:s.state.articles})},s.categoryBtn=function(t){s.setState({category:t,currPage:1,keywords:[]},s.getNews)},s.pageDecr=function(){s.state.currPage>1&&s.setState({currPage:s.state.currPage-1},s.getNews)},s.pageIncr=function(){s.state.articles.length>0&&s.setState({currPage:s.state.currPage+1},s.getNews)},s.handleChange=function(t){s.setState({currKeyword:t.target.value})},s.handleSubmit=function(t){""!==s.state.currKeyword&&s.setState({keywords:[s.state.currKeyword].concat(s.state.keywords),currKeyword:""},s.getNews),t.preventDefault()},s.clearKeywords=function(){s.setState({keywords:[]},s.getNews)},s.state={articles:[],refs:[],tab:!1,cache:[],cachedRefs:[],category:"",keywords:[],US:!0,currPage:1,currKeyword:""},s}return Object(l.a)(a,[{key:"render",value:function(){var t=this;return Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{align:"center",children:[Object(s.jsx)("button",{className:"styled categoryBtn",onClick:function(){return t.categoryBtn("entertainment")},children:"Entertainment"}),Object(s.jsx)("button",{className:"styled categoryBtn",onClick:function(){return t.categoryBtn("sports")},children:"Sports"}),Object(s.jsx)("button",{className:"styled categoryBtn",onClick:function(){return t.categoryBtn("technology")},children:"Technology"})]}),Object(s.jsxs)("div",{className:"controlbar",children:[Object(s.jsxs)("div",{className:"prevnext",children:[this.state.tab?null:Object(s.jsx)("button",{onClick:this.pageDecr,className:"styled",children:"prev"}),this.state.tab?null:Object(s.jsx)("button",{onClick:this.pageIncr,className:"styled",children:"next"})]}),Object(s.jsxs)("div",{className:"searchbar",children:[Object(s.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(s.jsx)("input",{type:"text",style:{marginLeft:10,marginRight:10},value:this.state.currKeyword,onChange:this.handleChange}),Object(s.jsx)("input",{type:"submit",value:"Add keyword"}),Object(s.jsx)("button",{onClick:this.clearKeywords,children:"Clear Filters"})]})," ",this.state.keywords.toString()," ",Object(s.jsx)("br",{})]}),Object(s.jsxs)("div",{className:"tab",children:[this.state.tab?Object(s.jsx)("button",{onClick:this.clearCache,className:"styled",children:"Clear"}):null,Object(s.jsx)("button",{onClick:this.toggleTab,className:"styled",children:this.state.tab?"Search results":"Saved articles"})]})]}),Object(s.jsx)("div",{className:"scrollable",children:Object(s.jsx)("ul",{children:this.state.articles.map((function(e,a){return Object(s.jsx)(d,{info:e,tab:t.state.tab,ref:t.state.refs[a]},t.state.tab+e.url)}))})})]})}}]),a}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(s.jsx)(n.a.StrictMode,{children:Object(s.jsx)(b,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[14,1,2]]]);
//# sourceMappingURL=main.de376b56.chunk.js.map