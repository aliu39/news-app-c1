(this["webpackJsonpnews-app"]=this["webpackJsonpnews-app"]||[]).push([[0],{13:function(t,e,a){},14:function(t,e,a){"use strict";a.r(e);var s=a(0),r=a(1),c=a.n(r),n=a(7),i=a.n(n),o=(a(13),a(2)),l=a(3),u=a(5),h=a(4);function d(t){var e=t.indexOf("T");return e>=0?t.slice(0,e):t}var b=function(t){Object(u.a)(a,t);var e=Object(h.a)(a);function a(t){var s;return Object(o.a)(this,a),(s=e.call(this,t)).saveArticle=function(){s.setState({cached:!0})},s.state={img_src:t.info.urlToImage,source:t.info.source.name,title:t.info.title,description:t.info.description,url:t.info.url,content:t.info.content,date:d(t.info.publishedAt),fullData:t.info,cached:!1,tab:t.tab},s}return Object(l.a)(a,[{key:"render",value:function(){return Object(s.jsxs)("div",{className:"article",children:[Object(s.jsx)("div",{className:"article-image",children:Object(s.jsx)("img",{src:null!=this.state.img_src?this.state.img_src:"https://www.sahilgraphics.com/wp-content/themes/shahil/assets/images/image-not-found.jpg",alt:"failed to load"})}),Object(s.jsxs)("div",{className:"article-content",children:[Object(s.jsxs)("p",{children:[Object(s.jsx)("b",{children:this.state.title+" | "+this.state.source+" | "+this.state.date})," ",Object(s.jsx)("br",{}),this.state.description," ",Object(s.jsx)("br",{})]}),Object(s.jsx)("p",{children:this.state.content}),Object(s.jsxs)("p",{align:"right",children:[Object(s.jsx)("a",{href:this.state.url,target:"_blank",rel:"noreferrer",children:"original article"})," ",Object(s.jsx)("br",{}),this.state.tab?null:Object(s.jsx)("button",{onClick:this.saveArticle,children:"save"})]})]})]})}}]),a}(c.a.Component),j=function(t){Object(u.a)(a,t);var e=Object(h.a)(a);function a(t){var s;return Object(o.a)(this,a),(s=e.call(this,t)).composeUrl=function(){var t="https://cors-anywhere.herokuapp.com/https://newsapi.org/v2/top-headlines?apiKey=78b9d599c4f94f8fa3afb1a5458928d6"+(s.state.US?"&country=us":"")+"&pageSize=20&page="+s.state.currPage+"&category="+s.state.category;return""!==s.state.keyword&&(t+="&q="+s.state.keyword),t},s.getNews=function(){if(""!==s.state.category){var t=new Headers;t.append("Accept","application/json");var e=s.composeUrl(),a=new Request(e,{method:"GET",headers:t,mode:"cors"});fetch(a).then((function(t){if(t.ok)return t.json();throw new Error("faulty response status "+t.status)})).then((function(t){s.state.tab&&s.toggleTab();for(var e=s.updateCache(),a=t.totalResults,r=[],n=[],i=0;i<t.articles.length;i++)r.push(t.articles[i]),n.push(c.a.createRef());s.setState({articles:r,refs:n,totalResults:a,requests:s.state.requests+1,cache:e},(function(){return s.scrollRef.current.scrollTop=0}))})).catch((function(t){console.log("ERROR: ",t.message)}))}},s.updateCache=function(){if(s.state.tab)return s.state.cache;for(var t=[],e=new Set,a=0,r=0;a<20&&r<s.state.refs.length;r++){var c=s.state.refs[r].current;c.state.cached&&(t.push(c.state.fullData),e.add(c.state.url),a++)}for(var n=0;a<20&&n<s.state.cache.length;n++){var i=s.state.cache[n];e.has(i.url)||(t.push(i),a++)}return t},s.clearCache=function(){s.state.tab&&s.setState({articles:[]})},s.toggleTab=function(){var t=s.updateCache();s.setState({articles:t,tab:!s.state.tab,cache:s.state.articles})},s.categoryBtn=function(t){s.setState({category:t,currPage:1,keyword:""},s.getNews)},s.pageDecr=function(){s.state.currPage>1&&s.setState({currPage:s.state.currPage-1},s.getNews)},s.pageIncr=function(){s.state.currPage<Math.ceil(s.state.totalResults/20)&&s.setState({currPage:s.state.currPage+1},s.getNews)},s.toggleCountry=function(){s.setState({US:!s.state.US},s.getNews)},s.handleChange=function(t){s.setState({formValue:t.target.value})},s.handleSubmit=function(t){""!==s.state.formValue&&s.setState({keyword:s.state.formValue,formValue:"",currPage:1},s.getNews),t.preventDefault()},s.clearKeyword=function(){s.setState({keyword:""},s.getNews)},s.state={articles:[],refs:[],tab:!1,cache:[],category:"",keyword:"",US:!0,currPage:1,formValue:"",totalResults:0,requests:0},s.scrollRef=c.a.createRef(),s}return Object(l.a)(a,[{key:"render",value:function(){var t=this;return Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{align:"center",children:[Object(s.jsx)("button",{className:"styled categoryBtn",onClick:function(){return t.categoryBtn("entertainment")},children:"Entertainment"}),Object(s.jsx)("button",{className:"styled categoryBtn",onClick:function(){return t.categoryBtn("sports")},children:"Sports"}),Object(s.jsx)("button",{className:"styled categoryBtn",onClick:function(){return t.categoryBtn("technology")},children:"Technology"})]}),Object(s.jsxs)("div",{className:"controlbar",children:[Object(s.jsxs)("div",{className:"prevnext",children:[this.state.tab||1===this.state.currPage?null:Object(s.jsx)("button",{onClick:this.pageDecr,className:"styled",children:"prev"}),this.state.tab||this.state.currPage>=Math.ceil(this.state.totalResults/20)?null:Object(s.jsx)("button",{onClick:this.pageIncr,className:"styled",children:"next"})]}),Object(s.jsxs)("div",{className:"searchbar",children:[Object(s.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(s.jsx)("input",{type:"text",style:{marginLeft:10,marginRight:10},value:this.state.formValue,onChange:this.handleChange}),Object(s.jsx)("input",{type:"submit",value:"Add keyword"}),Object(s.jsx)("button",{onClick:this.clearKeyword,children:"Clear Filters"}),Object(s.jsx)("button",{onClick:this.toggleCountry,children:this.state.US?"Intl.":"U.S."})]}),this.state.keyword," ",Object(s.jsx)("br",{})]}),Object(s.jsxs)("div",{className:"tab",children:[this.state.tab?Object(s.jsx)("button",{onClick:this.clearCache,className:"styled",children:"Clear"}):null,Object(s.jsx)("button",{onClick:this.toggleTab,className:"styled",children:this.state.tab?"Search results":"Saved articles"})]})]}),Object(s.jsxs)("div",{className:"scrollable",ref:this.scrollRef,children:[0===this.state.articles.length?Object(s.jsx)("h2",{children:Object(s.jsx)("b",{children:0===this.state.requests?"Click a category to begin":this.state.tab?"No saved articles":"No results found"})}):null,Object(s.jsx)("ul",{children:this.state.articles.map((function(e,a){return Object(s.jsx)(b,{info:e,tab:t.state.tab,ref:t.state.refs[a]},t.state.tab+a+e.url)}))})]})]})}}]),a}(c.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(s.jsx)(c.a.StrictMode,{children:Object(s.jsx)(j,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[14,1,2]]]);
//# sourceMappingURL=main.f11dee4a.chunk.js.map